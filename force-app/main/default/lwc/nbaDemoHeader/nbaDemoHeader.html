<template>
    <div class="header-container">
        <div class="header-left">
            <span class="breadcrumb">
                <span class="breadcrumb-prefix">GTM OS</span>
                <span class="breadcrumb-sep"> &gt; </span>
                <span class="breadcrumb-account">{headerData.accountName}</span>
            </span>
            <span class="badge mrr-badge">
                <lightning-icon icon-name="utility:moneybag" size="xx-small"></lightning-icon>
                {formattedMrr}
            </span>
            <span class="badge close-badge">
                <lightning-icon icon-name="utility:percent" size="xx-small"></lightning-icon>
                {formattedCloseProb}
            </span>
            <template lwc:if={isActionMode}>
                <span class={actionTypeBadgeClass}>{currentAction.actionType}</span>
                <template lwc:if={showCadenceStep}>
                    <span class="cadence-step-badge">
                        <lightning-icon icon-name={stepMethodIcon} size="xx-small" variant="inverse"></lightning-icon>
                        {cadenceStepLabel}
                    </span>
                </template>
            </template>
        </div>
        <div class="header-right">
            <div class="email-btn-wrapper">
                <div class="email-btn-group">
                    <button class="email-now-btn" onclick={handleEmailNow}>
                        <lightning-icon icon-name="utility:email" size="xx-small" variant="inverse"></lightning-icon>
                        Email Now
                    </button>
                    <button class="email-chevron-btn" onclick={handleEmailDropdown}>
                        <lightning-icon icon-name="utility:chevrondown" size="xx-small" variant="inverse"></lightning-icon>
                    </button>
                </div>
                <template if:true={showContactDropdown}>
                    <div class="contact-dropdown">
                        <div class="dropdown-header">SELECT RECIPIENT</div>
                        <template for:each={contactList} for:item="contact">
                            <div key={contact.contactId} class="dropdown-item" onclick={handleContactSelect} data-contact-id={contact.contactId}>
                                <div class="dropdown-contact-info">
                                    <span class="dropdown-contact-name">{contact.name}</span>
                                    <span class="dropdown-contact-title">{contact.title}</span>
                                </div>
                                <template if:true={contact.isPrimary}>
                                    <div class="primary-dot"></div>
                                </template>
                            </div>
                        </template>
                    </div>
                </template>
            </div>
            <div class="sms-btn-wrapper">
                <div class="sms-btn-group">
                    <button class="sms-now-btn" onclick={handleSmsNow}>
                        <lightning-icon icon-name="utility:chat" size="xx-small" variant="inverse"></lightning-icon>
                        SMS
                    </button>
                    <button class="sms-chevron-btn" onclick={handleSmsDropdown}>
                        <lightning-icon icon-name="utility:chevrondown" size="xx-small" variant="inverse"></lightning-icon>
                    </button>
                </div>
                <template if:true={showSmsContactDropdown}>
                    <div class="contact-dropdown">
                        <div class="dropdown-header">SELECT SMS RECIPIENT</div>
                        <template for:each={smsContactList} for:item="contact">
                            <div key={contact.contactId} class="dropdown-item" onclick={handleSmsContactSelect} data-contact-id={contact.contactId}>
                                <div class="dropdown-contact-info">
                                    <span class="dropdown-contact-name">{contact.name}</span>
                                    <span class="dropdown-contact-title">{contact.mogliNumber}</span>
                                </div>
                                <template if:true={contact.optedOut}>
                                    <span class="opted-out-badge">Opted Out</span>
                                </template>
                                <template if:false={contact.optedOut}>
                                    <template if:true={contact.isPrimary}>
                                        <div class="primary-dot"></div>
                                    </template>
                                </template>
                            </div>
                        </template>
                    </div>
                </template>
            </div>
            <template lwc:if={showSnoozeButton}>
                <button class="snooze-btn" onclick={handleSnooze}>
                    <lightning-icon icon-name="utility:clock" size="xx-small"></lightning-icon>
                    Snooze
                    <lightning-icon icon-name="utility:chevrondown" size="xx-small"></lightning-icon>
                </button>
            </template>
        </div>
    </div>
</template>
